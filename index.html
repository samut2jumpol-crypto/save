<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Money Saving</title>
  <!-- React + Babel CDN -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/lucide-static@latest/font/lucide.css">
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">

  // ===== Helpers =====
  const THB = (n) => n.toLocaleString(undefined, { style: 'currency', currency: 'THB', maximumFractionDigits: 2 })
  const parseAmount = (x) => { const n = Number((x || '').toString().replaceAll(',', '')); return isNaN(n) ? 0 : n }
  const uuid = () => Math.random().toString(36).slice(2)

  const CATS = ['ของกิน','เงินเดือน','เบี้ยเลี้ยง','ซื้อของ','ค่าเดินทาง','ค่าไฟ','ค่าเน็ต','อื่นๆ']

  // ===== Global Styles =====
  function GlobalStyles() {
    const css = `
      body{margin:0;background:#f8fafc;color:#0f172a;font-family:sans-serif}
      .container{width:min(1100px,92vw);margin:0 auto;padding:24px}
      .center{display:flex;min-height:100vh;align-items:center;justify-content:center;text-align:center}
      .title-hero{font-weight:900;font-size:clamp(40px,6vw,72px);margin:0}
      .sub-hero{color:#475569;margin-top:8px}
      .btn{border:1px solid #e5e7eb;background:#fff;border-radius:12px;padding:.75rem 1.1rem;cursor:pointer}
      .btn.primary{background:#2563eb;border-color:#2563eb;color:#fff}
      .btn.danger{background:#ef4444;border-color:#ef4444;color:#fff}
      .header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
      .brand{font-weight:800}
      .card{background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:16px;margin-bottom:20px}
      .title{font-weight:800;margin:0 0 8px 0}
      .muted{color:#475569}
      input,select{width:100%;padding:.65rem;border:1px solid #e5e7eb;border-radius:12px}
      .kpi{display:flex;gap:18px;flex-wrap:wrap}
      .kpi .box{flex:1;background:#fff;border:1px solid #e5e7eb;padding:12px 14px;border-radius:12px}
      .kpi .label{color:#475569;font-size:.9rem}
      .kpi .value{font-size:1.8rem;font-weight:900}
    `
    return <style>{css}</style>
  }

  // ===== Landing =====
  function Landing({ onStart }) {
    return (
      <div className="center">
        <div>
          <h1 className="title-hero">Money Saving</h1>
          <div className="sub-hero">ติดตามรายรับ–รายจ่าย ตั้งเป้าหมาย ออมเงินให้เติบโต</div>
          <div style={{ marginTop: 20 }}>
            <button className="btn primary" onClick={onStart}>เริ่มใช้งาน</button>
          </div>
        </div>
      </div>
    )
  }

  // ===== Goal Form =====
  function GoalForm({ onSave }) {
    const [amount, setAmount] = React.useState(0)
    const [period, setPeriod] = React.useState('month')
    return (
      <div className="card">
        <h3 className="title">กำหนดเป้าหมายการออม</h3>
        <div style={{display:"flex",gap:"10px",marginTop:"8px"}}>
          <input type="number" min={0} value={amount} onChange={e => setAmount(Number(e.target.value))} placeholder="3000" />
          <select value={period} onChange={e => setPeriod(e.target.value)}>
            <option value="day">ต่อวัน</option>
            <option value="month">ต่อเดือน</option>
            <option value="year">ต่อปี</option>
          </select>
          <button className="btn primary" onClick={() => onSave({ amount, period })}>บันทึก</button>
        </div>
      </div>
    )
  }

  // ===== Add Form =====
  function AddForm({ onAdd }) {
    const [type, setType] = React.useState('expense')
    const [category, setCategory] = React.useState('')
    const [amount, setAmount] = React.useState('')
    const add = () => { if (!amount) return; onAdd({ id: uuid(), type, category, amount }); setAmount(''); setCategory('') }
    return (
      <div className="card">
        <h3 className="title">บันทึกรายการ</h3>
        <div style={{display:"flex",gap:"10px"}}>
          <select value={type} onChange={e => setType(e.target.value)}>
            <option value="income">รายรับ</option>
            <option value="expense">รายจ่าย</option>
          </select>
          <input list="catlist" placeholder="หมวดหมู่" value={category} onChange={e => setCategory(e.target.value)} />
          <datalist id="catlist">{CATS.map(c => <option value={c} key={c} />)}</datalist>
          <input placeholder="จำนวนเงิน" value={amount} onChange={e => setAmount(e.target.value)} />
          <button className="btn primary" onClick={add}>เพิ่ม</button>
        </div>
      </div>
    )
  }

  // ===== Summary =====
  function Summary({ rows, goal }) {
    const income = rows.reduce((s, r) => s + (r.type === 'income' ? parseAmount(r.amount) : 0), 0)
    const expense = rows.reduce((s, r) => s + (r.type === 'expense' ? parseAmount(r.amount) : 0), 0)
    const left = income - expense
    return (
      <div className="card">
        <h3 className="title">สรุป</h3>
        <div className="kpi">
          <div className="box"><div className="label">คงเหลือ</div><div className="value">{THB(left)}</div></div>
          <div className="box"><div className="label">รายรับ</div><div className="value" style={{color:"green"}}>{THB(income)}</div></div>
          <div className="box"><div className="label">รายจ่าย</div><div className="value" style={{color:"red"}}>{THB(expense)}</div></div>
        </div>
        {goal && <div className="muted" style={{marginTop:"10px"}}>เป้าหมาย {THB(goal.amount)} / {goal.period}</div>}
      </div>
    )
  }

  // ===== App =====
  function App() {
    const [landing, setLanding] = React.useState(true)
    const [goal, setGoal] = React.useState(null)
    const [rows, setRows] = React.useState([])

    const addRow = (r) => setRows(prev => [r, ...prev])

    if (landing) return (<><GlobalStyles /><Landing onStart={() => setLanding(false)} /></>)

    return (
      <div className="container">
        <GlobalStyles />
        <div className="header">
          <div className="brand">Money Saving</div>
          <button className="btn" onClick={() => setLanding(true)}>กลับหน้าแรก</button>
        </div>
        <GoalForm onSave={g => setGoal(g)} />
        <AddForm onAdd={addRow} />
        <Summary rows={rows} goal={goal} />
      </div>
    )
  }

  const root = ReactDOM.createRoot(document.getElementById("root"))
  root.render(<App />)

  </script>
</body>
</html>
